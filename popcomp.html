<!DOCTYPE HTML>
<html>
	<head>
		<title>Post - ITSM ServiceNow Blog</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="single is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
				<header id="header">
					<h1><a href="index.html"><i class="fa fa-home">&nbsp;</i>Posts</a></h1>
					<nav class="links">
						<ul>
							<li><a href="#">Business Rules</a></li>
							<li><a href="#">Client Scripts</a></li>
							<li><a href="#">UI Actions</a></li>
							<li><a href="#">Reporting</a></li>
							<li><a href="#">Other</a></li>
						</ul>
					</nav>
				</header>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<article class="post">
								<header>
									<div class="title">
										<h2><a href="#">Quickly populate the Tasks associated computer</a></h2>
										<p>Automatically populate the callers primary assigned computer.</p>
									</div>
									<div class="meta">
										<time class="published" datetime="2019-08-01">August 1, 2019</time>
										<a href="#" class="author"><span class="name">JGriffin</span><img src="images/avatar.jpg" alt="Griffin avatar" /></a>
									</div>
								</header>
								<!--<span class="image featured"><img src="images/pic01.jpg" alt="" /></span>-->
								<p>This UI Action was created to help IT staff quickly populate the computer most likely associated with the IT incident being reported on the incident task form. The script 
									attempts to assign the primary hardware asset <code>[ALM_HARDWARE]</code>, sorted by the retirement date. If no primary assets are assigned, it will fall back on the 
									CMDB Computer <code>[CMDB_CI_Computer]</code> that they last logged into. Performing this task manually is tedious and thus is often forgotten or the wrong computer is selected.
								</p>
								<pre>
									<code class="language-javascript">
var caller = current.caller_id;
var grAsset = new GlideRecord('alm_hardware');
grAsset.addQuery('state', 'In use');
grAsset.addQuery('assigned_to', caller);
grAsset.addQuery('purpose', 'primary');
grAsset.orderByDesc('retirement_date');
grAsset.setLimit(1);
grAsset.query();
		
//Update associated computer with primary assigned asset
if (grAsset.next()) {
	current.setValue('u_assoc_comp_ci', grAsset.ci);
	current.update();
	gs.addInfoMessage('Populated associated computer, please verify asset details.');
} else {
	//Else update associated computer with assigned computer CI
	var grCompCI = new GlideRecord('cmdb_ci_computer');
	grCompCI.addQuery('assigned_to', caller);
	grCompCI.setLimit(1);
	grCompCI.query();
		
	if (grCompCI.next()) {
		current.setValue('u_assoc_comp_ci', grCompCI);
		current.update();
		gs.addInfoMessage('Populated associated computer, please verify asset details.');
	} else {
		gs.addInfoMessage('Unable to locate an assigned computer, please assign manaully.');
	}
}
action.setRedirectURL(current);
									</code>
								</pre>
							</article>

					</div>

				<!-- Footer -->
				<section id="footer">
					<ul class="icons">
						<li><a href="https://www.linkedin.com/in/jon-griffin-71124814" target="_blank" class="fab fa-linkedin-in"><span class="label">LinkedIn</span></a></li>
					</li>
					<!--Enkoder fun-->
					<li><script type="text/javascript">
							var x="function f(x){var i,o=\"\",ol=x.length,l=ol;while(x.charCodeAt(l/13)!" +
							"=92){try{x+=x;l+=l;}catch(e){}}for(i=l-1;i>=0;i--){o+=x.charAt(i);}return o" +
							".substr(0,ol);}f(\")83,\\\"220\\\\030\\\\430\\\\710\\\\700\\\\230\\\\Br\\\\" +
							"530\\\\630\\\\q771\\\\mo4&uqv{P*1N}umoa.W7z{fjf$mcqsBC^'730\\\\t\\\\720\\\\" +
							"330\\\\320\\\\300\\\\230\\\\620\\\\_020\\\\620\\\\On\\\\400\\\\000\\\\400\\" +
							"\\130\\\\I600\\\\010\\\\500\\\\410\\\\F?_220\\\\320\\\\>2>|y600\\\\474x9=2?" +
							"6020\\\\)($>, ir(2)-\\\"\\\\/c430\\\\200\\\\XXNS230\\\\X400\\\\520\\\\630\\" +
							"\\[XVFXBX000\\\\YBNG\\\\\\\\KHB\\\"(f};o nruter};))++y(^)i(tAedoCrahc.x(edo" +
							"CrahCmorf.gnirtS=+o;721=%y{)++i;l<i;0=i(rof;htgnel.x=l,\\\"\\\"=o,i rav{)y," +
							"x(f noitcnuf\")"                                                             ;
							while(x=eval(x));
						</script></li>
					</ul>
					<p class="copyright">&copy; Images: <a href="http://unsplash.com">Unsplash</a>.</p>
				</section>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script src="assets/js/prism.js"></script>

	</body>
	
</html>